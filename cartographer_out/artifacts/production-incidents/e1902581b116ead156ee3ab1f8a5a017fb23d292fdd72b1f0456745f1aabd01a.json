{
  "id": "e1902581b116ead156ee3ab1f8a5a017fb23d292fdd72b1f0456745f1aabd01a",
  "full_path": "do production-incidents create",
  "description": "Create a production incident",
  "permissions": "Admins can create production incidents. Non-admins can create if authorized for the incident subject: JobProductionPlan uses that plan's policy create permission; TenderJobScheduleShift uses its job production plan's policy create permission; Customer/Trucker/Developer/Contractor/MaterialSupplier/MaterialSite require update permission; Broker requires broker membership; ProjectTransportPlan requires update permission.",
  "side_effects": "Creates a production incident and may create or update incident unit-of-measure quantities for net impact; net impact minutes may be auto-calculated after save.",
  "validation_notes": "Required flags: --subject-type, --subject-id, --start-at, --status. --subject-type must be a valid subject class (JobProductionPlan, TenderJobScheduleShift, Broker, Customer, Trucker, Developer, Contractor, MaterialSupplier, MaterialSite, ProjectTransportPlan). --status must be one of open, closed, abandoned, processing, parked; --kind must be one of equipment, plant, trucking, crew, safety, quality, weather, traffic, capacity, job_site_condition, planning, subcontractor_delay, mobilization. --severity must be one of low, medium, high, catastrophic; --time-value-type must be one of deducted_time, credited_time. --end-at, if provided, must be after --start-at and is required when closing an incident. --net-impact-minutes and --net-impact-dollars must be numeric. --natures and --did-stop-work are not valid for production incidents. If --equipment is set, --job-production-plan must be set and the equipment must belong to that plan. If --tender-job-schedule-shift is set along with --job-production-plan, the shift must belong to the same plan and be a broker shift. If --assignee is set, the assignee must have a relationship with the customer and subject.",
  "flags": [
    {
      "name": "--subject-type",
      "aliases": null,
      "required": true,
      "type": "string",
      "description": "Subject type (required)",
      "default": null,
      "validation": "required; one of: JobProductionPlan, TenderJobScheduleShift, Broker, Customer, Trucker, Developer, Contractor, MaterialSupplier, MaterialSite, ProjectTransportPlan"
    },
    {
      "name": "--subject-id",
      "aliases": null,
      "required": true,
      "type": "string",
      "description": "Subject ID (required)",
      "default": null,
      "validation": "required"
    },
    {
      "name": "--start-at",
      "aliases": null,
      "required": true,
      "type": "string",
      "description": "Start timestamp (ISO 8601) (required)",
      "default": null,
      "validation": "required; ISO 8601 timestamp"
    },
    {
      "name": "--status",
      "aliases": null,
      "required": true,
      "type": "string",
      "description": "Status (required)",
      "default": null,
      "validation": "required; one of: open, closed, abandoned, processing, parked"
    },
    {
      "name": "--end-at",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "End timestamp (ISO 8601)",
      "default": null,
      "validation": "ISO 8601 timestamp; must be after --start-at"
    },
    {
      "name": "--kind",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Incident kind",
      "default": null,
      "validation": "one of: equipment, plant, trucking, crew, safety, quality, weather, traffic, capacity, job_site_condition, planning, subcontractor_delay, mobilization"
    },
    {
      "name": "--description",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Description",
      "default": null,
      "validation": null
    },
    {
      "name": "--natures",
      "aliases": null,
      "required": false,
      "type": "array",
      "description": "Incident natures (comma-separated, not valid for production incidents)",
      "default": null,
      "validation": "not valid for production incidents"
    },
    {
      "name": "--severity",
      "aliases": null,
      "required": false,
      "type": "enum",
      "description": "Severity (low, medium, high, catastrophic)",
      "default": null,
      "validation": "one of: low, medium, high, catastrophic"
    },
    {
      "name": "--time-value-type",
      "aliases": null,
      "required": false,
      "type": "enum",
      "description": "Time value type (deducted_time, credited_time)",
      "default": null,
      "validation": "one of: deducted_time, credited_time"
    },
    {
      "name": "--headline",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Headline",
      "default": null,
      "validation": null
    },
    {
      "name": "--net-impact-minutes",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Net impact minutes",
      "default": null,
      "validation": "numeric"
    },
    {
      "name": "--net-impact-dollars",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Net impact dollars",
      "default": null,
      "validation": "numeric"
    },
    {
      "name": "--is-down-time",
      "aliases": null,
      "required": false,
      "type": "boolean",
      "description": "Down time flag",
      "default": null,
      "validation": null
    },
    {
      "name": "--did-stop-work",
      "aliases": null,
      "required": false,
      "type": "boolean",
      "description": "Did stop work (not valid for production incidents)",
      "default": null,
      "validation": "not valid for production incidents"
    },
    {
      "name": "--job-production-plan",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Job production plan ID",
      "default": null,
      "validation": null
    },
    {
      "name": "--equipment",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Equipment ID",
      "default": null,
      "validation": "requires --job-production-plan; equipment must be related to that job production plan"
    },
    {
      "name": "--tender-job-schedule-shift",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Tender job schedule shift ID",
      "default": null,
      "validation": "if --job-production-plan is set, shift must belong to same job production plan and be a broker shift"
    },
    {
      "name": "--assignee",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Assignee user ID",
      "default": null,
      "validation": "assignee must be related to the customer and subject"
    },
    {
      "name": "--parent-id",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Parent incident ID",
      "default": null,
      "validation": null
    },
    {
      "name": "--parent-type",
      "aliases": null,
      "required": false,
      "type": "string",
      "description": "Parent incident type (e.g., production-incidents)",
      "default": null,
      "validation": null
    }
  ],
  "sources": [
    {
      "repo_name": "cli",
      "file_path": "internal/cli/do_production_incidents_create.go"
    },
    {
      "repo_name": "cli",
      "file_path": "internal/cli/liability_incidents_common.go"
    },
    {
      "repo_name": "server",
      "file_path": "app/controllers/v1/production_incidents_controller.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/controllers/v1/incidents_controller.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/policies/incident_policy.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/policies/production_incident_policy.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/models/incident.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/models/incidents/production_incident.rb"
    }
  ]
}
