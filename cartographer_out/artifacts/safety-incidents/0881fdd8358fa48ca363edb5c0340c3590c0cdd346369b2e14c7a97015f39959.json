{
  "id": "0881fdd8358fa48ca363edb5c0340c3590c0cdd346369b2e14c7a97015f39959",
  "full_path": "do safety-incidents create",
  "description": "Create a safety incident",
  "permissions": "Admins can create. Non-admins can create only if authorized for the subject: JobProductionPlan (create?), TenderJobScheduleShift (create? on its job production plan), Customer/Trucker/Developer/Contractor/MaterialSupplier/MaterialSite (update?), Broker (practically a member), ProjectTransportPlan (update?).",
  "side_effects": "Creates a safety incident. May create/update an incident unit-of-measure quantity for net impact tons, create assignment/status change notifications, create a subscription for the creator, update headline/tags asynchronously, and trigger other incident side effects on create.",
  "validation_notes": "Required flags: --subject-type, --subject-id, --start-at, --status. --start-at must be present; --status must be present and one of: open, closed, abandoned, processing, parked. --kind must be one of: near_miss, good_catch, damage, overloading, work_zone_intrusion. --severity must be one of: low, medium, high, catastrophic. --natures accepts values from: personal, property (unique). --end-at must be greater than --start-at; when status is closed, end-at is required. --subject-type must be a valid JSON:API type for the subject; subject_type must map to one of: JobProductionPlan, TenderJobScheduleShift, Broker, Customer, Trucker, Developer, Contractor, MaterialSupplier, MaterialSite, ProjectTransportPlan. --net-impact-tons must be numeric and >= 0 and only applies when kind is overloading. Server validates relationship consistency (e.g., tender job schedule shift and equipment must align with job production plan; assignee must be valid for the customer; tender job schedule shift must be a broker shift; incidents may be blocked for unmanaged shifts).",
  "flags": [
    {
      "name": "--subject-type",
      "required": true,
      "type": "string",
      "description": "Subject type (JSON:API type, e.g., brokers, job-production-plans)",
      "validation": "JSON:API type for subject"
    },
    {
      "name": "--subject-id",
      "required": true,
      "type": "string",
      "description": "Subject ID"
    },
    {
      "name": "--start-at",
      "required": true,
      "type": "string",
      "description": "Start timestamp (ISO 8601)",
      "validation": "ISO 8601 timestamp"
    },
    {
      "name": "--status",
      "required": true,
      "type": "enum",
      "description": "Status (open, closed, abandoned, processing, parked)",
      "validation": "open|closed|abandoned|processing|parked"
    },
    {
      "name": "--kind",
      "required": false,
      "type": "enum",
      "description": "Kind (near_miss, good_catch, damage, overloading, work_zone_intrusion)",
      "validation": "near_miss|good_catch|damage|overloading|work_zone_intrusion"
    },
    {
      "name": "--severity",
      "required": false,
      "type": "enum",
      "description": "Severity (low, medium, high, catastrophic)",
      "validation": "low|medium|high|catastrophic"
    },
    {
      "name": "--headline",
      "required": false,
      "type": "string",
      "description": "Headline text"
    },
    {
      "name": "--description",
      "required": false,
      "type": "string",
      "description": "Description text"
    },
    {
      "name": "--natures",
      "required": false,
      "type": "array",
      "description": "Incident natures (comma-separated: personal,property)",
      "validation": "personal|property"
    },
    {
      "name": "--did-stop-work",
      "required": false,
      "type": "boolean",
      "description": "Whether work stopped"
    },
    {
      "name": "--end-at",
      "required": false,
      "type": "string",
      "description": "End timestamp (ISO 8601)",
      "validation": "ISO 8601 timestamp"
    },
    {
      "name": "--net-impact-tons",
      "required": false,
      "type": "string",
      "description": "Net impact tons (overloading only)",
      "validation": "number >= 0"
    },
    {
      "name": "--parent",
      "required": false,
      "type": "string",
      "description": "Parent incident ID"
    },
    {
      "name": "--equipment",
      "required": false,
      "type": "string",
      "description": "Equipment ID"
    },
    {
      "name": "--job-production-plan",
      "required": false,
      "type": "string",
      "description": "Job production plan ID"
    },
    {
      "name": "--assignee",
      "required": false,
      "type": "string",
      "description": "Assignee user ID"
    },
    {
      "name": "--tender-job-schedule-shift",
      "required": false,
      "type": "string",
      "description": "Tender job schedule shift ID"
    }
  ],
  "sources": [
    {
      "repo_name": "cli",
      "file_path": "internal/cli/do_safety_incidents_create.go"
    },
    {
      "repo_name": "server",
      "file_path": "app/policies/incident_policy.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/resources/v1/incident_resource.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/resources/v1/safety_incident_resource.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/models/incident.rb"
    },
    {
      "repo_name": "server",
      "file_path": "app/models/incidents/safety_incident.rb"
    }
  ]
}